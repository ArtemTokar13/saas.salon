{% load i18n %}
{% load static %}
<nav class="bg-white shadow-md sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- LEFT: Logo & Brand -->
      <div class="flex items-center gap-3">
        <a href="{% url 'index' %}" class="flex items-center gap-3">
          <img class="w-10 h-8" src="{% static 'img/logo.png' %}" alt="Logo">
          <span class="text-gray-800 font-bold text-xl leading-none select-none">
            ReservaYa
          </span>
        </a>
      </div>

      <!-- CENTER: Desktop menu -->
      <div class="hidden md:flex md:items-center md:space-x-6">
        <a href="{% url 'index' %}" class="text-sm font-medium text-gray-700 hover:text-gray-900">{% trans "Home" %}</a>
        <a href="{% url 'view_plans' %}" class="text-sm font-medium text-gray-700 hover:text-gray-900">{% trans "Pricing" %}</a>
      </div>

      <!-- RIGHT: Auth -->
      <div class="hidden md:flex md:items-center md:gap-4">
        {% if user.is_authenticated %}
          <span class="text-sm text-gray-700">{% trans "Hello" %}, {{ user.username }}</span>
          {% if user.is_superuser or user.is_staff %}
            <a href="{% url 'admin_dashboard' %}" class="text-sm font-medium text-gray-800 hover:text-gray-600">
              <i class="fas fa-cog mr-1"></i>{% trans "Platform Admin" %}
            </a>
          {% elif user.userprofile.is_admin %}
            <a href="{% url 'company_dashboard' %}" class="text-sm font-medium text-gray-700 hover:text-gray-900">{% trans "Dashboard" %}</a>
          {% else %}
            <a href="{% url 'booking_calendar' %}" class="bg-gray-800 text-white px-2 py-1 rounded-lg font-semibold hover:bg-gray-700 transition">{% trans "Calendar" %}</a>
          {% endif %}
          <form method="post" action="{% url 'logout' %}" class="inline">
            {% csrf_token %}
            <button type="submit" class="text-sm font-medium text-gray-700 hover:text-gray-600">{% trans "Logout" %}</button>
          </form>
        {% else %}
          <a href="{% url 'login' %}" class="px-4 py-2 border-2 border-gray-800 text-gray-800 rounded-md font-semibold hover:bg-gray-800 hover:text-white transition">{% trans "Login" %}</a>
          <a href="{% url 'register_company' %}" class="text-l text-gray-800 font-bold underline hover:text-gray-600">{% trans "Try Free" %}</a>
        {% endif %}
        {% include '_language_switcher.html' %}
      </div>

      <!-- MOBILE: Try Free link + burger -->
      <div class="md:hidden flex items-center gap-4">
        {% if not user.is_authenticated %}
          <a href="{% url 'register_company' %}" class="text-l text-gray-800 font-bold underline hover:text-gray-600">{% trans "Try Free" %}</a>
        {% endif %}
        <button id="nav-toggle" onclick="toggleMobileMenu()" class="text-gray-700">
          <svg id="burger-open" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg id="burger-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- MOBILE MENU -->
  <div id="mobile-menu" class="md:hidden hidden bg-white border-t">
    <div class="px-4 py-3 space-y-2">
      <a href="{% url 'index' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-100">{% trans "Home" %}</a>
      <a href="{% url 'view_plans' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-100">{% trans "Pricing" %}</a>

      <div class="border-t border-gray-200 my-2"></div>

      {% if user.is_authenticated %}
        <div class="px-3 py-2 text-sm text-gray-600">{% trans "Hello" %}, {{ user.username }}</div>
        {% if user.is_superuser or user.is_staff %}
          <a href="{% url 'admin_dashboard' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-800 hover:bg-gray-100">
            <i class="fas fa-cog mr-2"></i>{% trans "Platform Admin" %}
          </a>
        {% elif user.userprofile.is_admin %}
          <a href="{% url 'company_dashboard' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-gray-100">{% trans "Dashboard" %}</a>
        {% endif %}
        <form method="post" action="{% url 'logout' %}" class="px-3">
          {% csrf_token %}
          <button type="submit" class="w-full text-left py-2 text-base text-gray-700 hover:text-gray-900">{% trans "Logout" %}</button>
        </form>
      {% else %}
        <a href="{% url 'login' %}" class="block mx-3 my-2 px-3 py-2 border-2 border-gray-800 text-gray-800 rounded-md text-base font-semibold hover:bg-gray-800 hover:text-white text-center transition">{% trans "Login" %}</a>
        <a href="{% url 'register_company' %}" class="block mx-3 my-2 px-3 py-2 rounded-md text-base font-semibold bg-gray-800 text-white hover:bg-gray-600 text-center">{% trans "Try Free" %}</a>
      {% endif %}
      
      <div class="border-t border-gray-200 my-2"></div>
      <div class="px-3">
        {% include '_language_switcher.html' %}
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const openIcon = document.getElementById('burger-open');
    const closeIcon = document.getElementById('burger-close');
    if (!menu) return;
    const isHidden = menu.classList.contains('hidden');
    if (isHidden) {
      menu.classList.remove('hidden');
      openIcon.classList.add('hidden');
      closeIcon.classList.remove('hidden');
    } else {
      menu.classList.add('hidden');
      openIcon.classList.remove('hidden');
      closeIcon.classList.add('hidden');
    }
  }
</script>