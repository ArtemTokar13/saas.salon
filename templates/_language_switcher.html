{% load i18n %}

<div class="relative inline-block text-left" x-data="{ open: false }">
  {% get_current_language as LANGUAGE_CODE %}
  {% get_available_languages as LANGUAGES %}

  <button
    @click="open = !open"
    @click.away="open = false"
    type="button"
    class="inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900"
  >
    <i class="fas fa-globe"></i>

    {# Показуємо назву мови, а не код #}
    {% for code, name in LANGUAGES %}
      {% if code == LANGUAGE_CODE %}
        <span class="hidden sm:inline">{{ name }}</span>
      {% endif %}
    {% endfor %}

    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
    </svg>
  </button>

  <div
    x-show="open"
    x-transition
    class="absolute left-0 sm:right-0 sm:left-auto mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50"
  >
    <div class="py-1">
      {% for code, name in LANGUAGES %}
        <form action="{% url 'set_language' %}" method="post">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.get_full_path }}">
          <input type="hidden" name="language" value="{{ code }}">

          <button
            type="submit"
            class="w-full text-left px-4 py-2 text-sm hover:bg-gray-100
            {% if code == LANGUAGE_CODE %}bg-gray-100 font-semibold{% endif %}">
            {{ name }}
          </button>
        </form>
      {% endfor %}
    </div>
  </div>
</div>
